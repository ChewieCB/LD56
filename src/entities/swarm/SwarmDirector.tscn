[gd_scene load_steps=8 format=3 uid="uid://1bwiqif7rpyi"]

[ext_resource type="Script" path="res://src/entities/swarm/swarm_director.gd" id="1_ol7n7"]
[ext_resource type="Texture2D" uid="uid://d2an8sg7yxult" path="res://icon.svg" id="2_luj07"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="2_od00x"]
[ext_resource type="Script" path="res://addons/godot_state_charts/parallel_state.gd" id="3_rjk1i"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="4_xwfoj"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="5_02wus"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="6_s0myw"]

[node name="SwarmDirector" type="Node2D" node_paths=PackedStringArray("state_chart")]
script = ExtResource("1_ol7n7")
state_chart = NodePath("StateChart")
normal_separation = 0.1
close_separation = 0.05
far_separation = 0.2
swarm_agent_count = 60

[node name="TargetMarker" type="Marker2D" parent="."]

[node name="Sprite2D" type="Sprite2D" parent="TargetMarker"]
visible = false
scale = Vector2(0.25, 0.25)
texture = ExtResource("2_luj07")

[node name="StateChart" type="Node" parent="."]
script = ExtResource("2_od00x")

[node name="Root" type="Node" parent="StateChart"]
script = ExtResource("3_rjk1i")

[node name="Movement" type="Node" parent="StateChart/Root"]
script = ExtResource("4_xwfoj")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateChart/Root/Movement"]
script = ExtResource("5_02wus")

[node name="toMoving" type="Node" parent="StateChart/Root/Movement/Idle"]
script = ExtResource("6_s0myw")
to = NodePath("../../Moving")
event = &"start_moving"
delay_in_seconds = "0.0"

[node name="Moving" type="Node" parent="StateChart/Root/Movement"]
script = ExtResource("5_02wus")

[node name="toIdle" type="Node" parent="StateChart/Root/Movement/Moving"]
script = ExtResource("6_s0myw")
to = NodePath("../../Idle")
event = &"stop_moving"
delay_in_seconds = "0.0"

[node name="Distribution" type="Node" parent="StateChart/Root"]
script = ExtResource("4_xwfoj")
initial_state = NodePath("Normal")

[node name="Normal" type="Node" parent="StateChart/Root/Distribution"]
script = ExtResource("5_02wus")

[node name="toClose" type="Node" parent="StateChart/Root/Distribution/Normal"]
script = ExtResource("6_s0myw")
to = NodePath("../../Close")
event = &"clump_together"
delay_in_seconds = "0.0"

[node name="toFar" type="Node" parent="StateChart/Root/Distribution/Normal"]
script = ExtResource("6_s0myw")
to = NodePath("../../Far")
event = &"spread_out"
delay_in_seconds = "0.0"

[node name="Close" type="Node" parent="StateChart/Root/Distribution"]
script = ExtResource("5_02wus")

[node name="toNormal" type="Node" parent="StateChart/Root/Distribution/Close"]
script = ExtResource("6_s0myw")
to = NodePath("../../Normal")
event = &"reset_distribution"
delay_in_seconds = "0.0"

[node name="toFar" type="Node" parent="StateChart/Root/Distribution/Close"]
script = ExtResource("6_s0myw")
to = NodePath("../../Far")
event = &"spread_out"
delay_in_seconds = "0.0"

[node name="Far" type="Node" parent="StateChart/Root/Distribution"]
script = ExtResource("5_02wus")

[node name="toNormal" type="Node" parent="StateChart/Root/Distribution/Far"]
script = ExtResource("6_s0myw")
to = NodePath("../../Normal")
event = &"reset_distribution"
delay_in_seconds = "0.0"

[node name="toClose" type="Node" parent="StateChart/Root/Distribution/Far"]
script = ExtResource("6_s0myw")
to = NodePath("../../Close")
event = &"clump_together"
delay_in_seconds = "0.0"

[connection signal="state_entered" from="StateChart/Root/Distribution/Normal" to="." method="_on_distribution_normal_state_entered"]
[connection signal="state_entered" from="StateChart/Root/Distribution/Close" to="." method="_on_distribution_close_state_entered"]
[connection signal="state_entered" from="StateChart/Root/Distribution/Far" to="." method="_on_distribution_far_state_entered"]
